(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3bfc840d"],{"47e9":function(t,e,i){"use strict";var a=i("d402"),n=i.n(a);n.a},"81f6":function(t,e){},b52d:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-container",{attrs:{"fill-height":"",fluid:"","grid-list-xl":""}},[i("v-layout",{attrs:{wrap:""}},[[i("v-layout",[1===t.user.role_id||2===t.user.role_id?i("v-flex",{attrs:{xs12:"",md6:"",lg2:""}},[i("v-combobox",{attrs:{items:t.all_counties,"item-text":"name","item-value":"id",label:"Select County",multiple:"",clearable:"","persistent-hint":"",chips:""},on:{change:t.getSubCounties},model:{value:t.counties,callback:function(e){t.counties=e},expression:"counties"}})],1):t._e(),t._v(" "),5===t.user.role_id?i("v-flex",{attrs:{xs10:"",md2:""}},[i("v-combobox",{attrs:{disabled:"",chips:""},model:{value:this.user.county,callback:function(e){t.$set(this.user,"county",e)},expression:"this.user.county"}})],1):t._e(),t._v(" "),1===t.user.role_id||2===t.user.role_id?i("v-flex",{attrs:{xs12:"",md6:"",lg2:""}},[i("v-combobox",{attrs:{items:t.all_subcounties,"item-text":"name","item-value":"id",label:"Select Sub-County",disabled:t.active,multiple:"",clearable:"","persistent-hint":"",chips:""},on:{change:t.facilitySubCounty},model:{value:t.subcounties,callback:function(e){t.subcounties=e},expression:"subcounties"}})],1):t._e(),t._v(" "),5===t.user.role_id?i("v-flex",{attrs:{xs12:"",md2:""}},[i("v-combobox",{attrs:{items:t.all_subcounties,"item-text":"name","item-value":"id",label:"Select Sub-County",multiple:"",clearable:"","persistent-hint":"",chips:""},on:{change:t.getFacilitysubcountyfilter},model:{value:t.subcounties,callback:function(e){t.subcounties=e},expression:"subcounties"}})],1):t._e(),t._v(" "),4!==t.user.role_id?i("v-flex",{attrs:{xs12:"",md6:"",lg2:""}},[i("v-combobox",{attrs:{items:t.all_partners,"item-text":"name","item-value":"id",label:"Select Partner",multiple:"",clearable:"",disabled:"","persistent-hint":"",chips:""},model:{value:t.partner,callback:function(e){t.partner=e},expression:"partner"}})],1):t._e(),t._v(" "),i("v-flex",{attrs:{xs12:"",md6:"",lg2:""}},[4!==t.user.role_id?i("v-combobox",{attrs:{items:t.all_facilities_level,label:"Select Facility Level",disabled:t.active_level,multiple:"",clearable:"","persistent-hint":"",chips:""},on:{change:t.facilityLevel}}):t._e()],1),t._v(" "),4!==t.user.role_id?i("v-flex",{attrs:{xs12:"",md6:"",lg3:""}},[i("v-combobox",{attrs:{items:t.fac,"item-text":"name","item-value":"id",label:"Select Facility",disabled:t.active_fac,multiple:"",clearable:"","persistent-hint":"",chips:""},on:{change:t.facilityFilter},model:{value:t.facility,callback:function(e){t.facility=e},expression:"facility"}})],1):t._e()],1),t._v(" "),[i("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[i("v-menu",{ref:"menu1",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":t.startDate,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(e){t.startDate=e}},model:{value:t.menu1,callback:function(e){t.menu1=e},expression:"menu1"}},[i("v-text-field",{attrs:{slot:"activator",label:"Start Date","prepend-icon":"mdi-calendar",readonly:""},slot:"activator",model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),i("v-date-picker",{attrs:{dark:!0,"no-title":"",scrollable:"",max:t.endDate,min:t.minDate},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}},[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.menu1=!1}}},[t._v("Cancel")]),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.click(),t.$refs.menu1.save(t.startDate),t.click}}},[t._v("OK")])],1)],1)],1),t._v(" "),i("v-flex",{attrs:{xs12:"",sm6:"",md3:""}},[i("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":t.endDate,lazy:"",transition:"scale-transition","offset-y":"","full-width":"","min-width":"290px"},on:{"update:returnValue":function(e){t.endDate=e}},model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[i("v-text-field",{attrs:{slot:"activator",label:"End Date","prepend-icon":"mdi-calendar",readonly:""},slot:"activator",model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}}),t._v(" "),i("v-date-picker",{attrs:{dark:!0,"no-title":"",scrollable:"",max:t.maxDate,min:t.startDate},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}},[i("v-spacer"),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.menu=!1}}},[t._v("Cancel")]),t._v(" "),i("v-btn",{attrs:{flat:"",color:"primary"},on:{click:function(e){t.click(),t.$refs.menu.save(t.endDate)}}},[t._v("OK")])],1)],1)],1)],t._v(" "),i("div",{staticClass:"text-center"},[i("v-btn",{attrs:{"x-large":"",color:"secondary",darknt:""},on:{click:t.click}},[t._v("Filter")]),t._v(" "),i("v-btn",{attrs:{loading:t.downloadLoading,color:"primary","x-large":""},on:{click:t.handleDownload}},[i("v-icon",{attrs:{left:""}},[t._v("mdi-download")]),t._v("Export Excel\n      ")],1)],1)],t._v(" "),[i("v-flex",{attrs:{xs12:"",md12:""}},[i("div",{staticClass:"card vld-parent"},[i("loading",{attrs:{active:t.isLoading,"can-cancel":!1,"on-cancel":t.onCancel,loader:"dots","is-full-page":t.fullPage},on:{"update:active":function(e){t.isLoading=e}}}),t._v(" "),i("h3"),t._v(" "),i("highcharts",{ref:"columnChart",attrs:{options:t.barOptionsHBV}})],1)])]],2)],1)},n=[],s=i("4795"),l=i.n(s),o=i("4452"),r=i("bc3a"),c=i.n(r),u=i("9062"),f=i.n(u),h=(i("e40d"),i("ea7f")),d=i.n(h),v=(i("c1df"),i("2f62"));i("81f6");function m(t,e,i,a,n,s,l){try{var o=t[s](l),r=o.value}catch(c){return void i(c)}o.done?e(r):Promise.resolve(r).then(a,n)}function p(t){return function(){var e=this,i=arguments;return new Promise((function(a,n){var s=t.apply(e,i);function l(t){m(s,a,n,l,o,"next",t)}function o(t){m(s,a,n,l,o,"throw",t)}l(void 0)}))}}function _(t){return _="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function x(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach((function(e){g(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var y={components:{Loading:f.a,highcharts:o["Chart"]},data:function(){return{isLoading:!0,fullPage:!1,menu:!1,menu1:!1,startDate:"2017-01-01",maxDate:(new Date).toISOString().substr(0,10),minDate:"2017-01-01",endDate:(new Date).toISOString().substr(0,10),facility:"",partner:"",counties:"",subcounties:"",fac:[],all_facilities:[],all_facilities_level:["Level 1","Level 2","Level 3","Level 4","Level 5 and Above"],all_counties:[],all_subcounties:[],all_partners:[],active:!0,active_fac:!0,active_level:!0,downloadLoading:!1,filename:"HBV Report ".concat((new Date).toISOString()),autoWidth:!0,bookType:"xlsx",barOptionsHBV:{chart:{type:"column",options3d:{enabled:!0,alpha:45}},title:{text:"Immunizations by HBV"},xAxis:{categories:["Dose 1","Dose 2","Dose 3"]},plotOptions:{column:{dataLabels:{enabled:!0}}},labels:{items:[{html:"",style:{left:"50px",top:"18px",color:d.a.theme&&d.a.theme.textColor||"black"}}]},series:[{colorByPoint:!0,name:"HBV Immunizations",data:[]}]},seriesname:[1,2,3],hbvs:[],s:[],userz:[],load:!0,fac_filt:[],exp_filt:[],us_filt:[],fac_filtl:[],exp_filtl:[],us_filtl:[],fac_filtf:[],exp_filtf:[],us_filtf:[]}},computed:x({},Object(v["c"])({user:"auth/user"})),created:function(){this.getImmunizations(),this.getFacilities(),this.getCounties(),this.getPartners()},methods:{onCancel:function(){},click:function(){var t=[],e={convert:function(t){return t.constructor===Date?t:t.constructor===Array?new Date(t[0],t[1],t[2]):t.constructor===Number||t.constructor===String?new Date(t):"object"===_(t)?new Date(t.year,t.month,t.date):NaN},inRange:function(t,e,i){return isFinite(t=this.convert(t).valueOf())&&isFinite(e=this.convert(e).valueOf())&&isFinite(i=this.convert(i).valueOf())?e<=t&&t<=i:NaN}};for(var i in this.s){var a=new Date(this.s[i].created_at).toISOString().substr(0,10);e.inRange(a,this.startDate,this.endDate)&&t.push(this.s[i])}this.getHBV(t)},getFacilities:function(){var t=this;c.a.get("facilities").then((function(e){t.all_facilities=e.data.data})).catch((function(t){return console.log(t.message)}))},getCounties:function(){var t=this;c.a.get("counties").then((function(e){t.all_counties=e.data.data})).catch((function(t){return console.log(t.message)}))},getSubCounties:function(t){var e=this;if(t.length>0){for(var i in this.active=!1,this.all_subcounties=[],t)c.a.get("subcounties/".concat(t[i].id)).then((function(t){e.all_subcounties=e.all_subcounties.concat(t.data.data)})).catch((function(t){return console.log(t.message)}));this.facilityCounty(t)}else this.active=!0,this.facilityCounty(t)},facilityCounty:function(t){if(this.us_filt=[],this.fac_filt=[],this.exp_filt=[],t.length>0){for(var e in t){for(var i in this.all_facilities)this.all_facilities[i].county==t[e].name&&this.fac_filt.push(this.all_facilities[i]);for(var a in this.s)this.s[a].county==t[e].name&&this.exp_filt.push(this.s[a])}this.getHBV(this.exp_filt),this.fac=this.fac_filt.sort()}else this.fac=this.all_facilities,this.getHBV(this.s)},facilitySubCounty:function(t){if(this.exp_filtl=[],this.fac_filtl=[],this.us_filtl=[],this.active_level=!1,t.length>0){for(var e in t){for(var i in this.fac_filt)this.fac_filt[i].sub_county==t[e].name&&this.fac_filtl.push(this.fac_filt[i]);for(var a in this.exp_filt)this.exp_filt[a].sub_county==t[e].name&&this.exp_filtl.push(this.exp_filt[a])}this.getHBV(this.exp_filtl),this.fac=this.fac_filtl.sort()}else this.fac=this.fac_filt,this.getHBV(this.exp_filt),this.active_level=!0},facilityLevel:function(t){if(this.fac_filtf=[],this.exp_filtf=[],this.active_fac=!1,t.length>0){for(var e in t){for(var i in this.fac_filtl)(this.fac_filtl[i].level==t[e]||"Level 5 and Above"==t[e]&&Number(this.fac_filtl[i].level.slice(6,7))>=5)&&this.fac_filtf.push(this.fac_filtl[i]);for(var a in this.exp_filtl)(this.exp_filtl[a].facility_level==t[e]||"Level 5 and Above"==t[e]&&Number(this.exp_filtl[a].facility_level.slice(6,7))>=5)&&this.exp_filtf.push(this.exp_filtl[a])}this.getHBV(this.exp_filtf),this.fac=this.fac_filtf.sort()}else this.fac=this.fac_filtl,this.active_fac=!0,this.getHBV(this.exp_filtl)},facilityFilter:function(t){var e=[];if(t.length>0){for(var i in t)for(var a in this.exp_filtf)this.exp_filtf[a].facility_name==t[i].name&&e.push(this.exp_filtf[a]);this.getHBV(e)}else this.getHBV(this.exp_filtf)},getImmunizations:function(){var t=this;1===this.user.role_id||2==this.user.role_id||5==this.user.role_id?c.a.get("immunizations/all/disease/1").then((function(e){t.s=e.data.data,null!=e.data.links.next?(t.link=e.data.links.next,t.loopT(t.link)):(t.getHBV(t.s),t.isLoading=!1)})).catch((function(t){return console.log(t.message)})):4===this.user.role_id&&c.a.get("immunizations/facility/".concat(this.user.hcw.facility_id,"/disease/1")).then((function(e){t.s=e.data.data,null!=e.data.links.next?(t.link=e.data.links.next,t.loopT(t.link)):(t.getHBV(t.s),t.isLoading=!1)})).catch((function(t){return console.log(t.message)}))},getPartners:function(){var t=this;c.a.get("partners").then((function(e){t.all_partners=e.data.data})).catch((function(t){return console.log(t.message)}))},loopT:function(t){var e=this;return p(l.a.mark((function i(){var a,n;return l.a.wrap((function(i){while(1)switch(i.prev=i.next){case 0:a=0;case 1:if(!(a<1)){i.next=13;break}if(null==t){i.next=10;break}return i.next=5,c.a.get(t);case 5:n=i.sent,t=n.data.links.next,e.s=e.s.concat(n.data.data),i.next=11;break;case 10:a=11;case 11:i.next=1;break;case 13:e.getHBV(e.s),e.isLoading=!1;case 15:case"end":return i.stop()}}),i)})))()},getHBV:function(t){for(var e in this.seriesdata=[],this.seriesname)this.seriesdata.push(this.getNum(e,t));this.barOptionsHBV.series[0].data=this.seriesdata},getNum:function(t,e){var i,a=[],n=[],s=0,l=[];for(var o in e)l.push(e[o].user_id);l.sort();for(var r=0;r<l.length;r++)l[r]!==i?(a.push(l[r]),n.push(1)):n[n.length-1]++,i=l[r];for(var c in n)(0==t&&n[c]||1==t&&2===n[c]||3===n[c]||2==t&&3===n[c])&&s++;return s},handleDownload:function(){var t=this;this.downloadLoading=!0,i.e("chunk-0e610f46").then(i.bind(null,"4bf8")).then((function(e){var i=["First Name","Surname","Gender","Phone Number","Disease Name","Date","County","Sub County","Facility Name","Facility Level"],a=["first_name","surname","gender","msisdn","disease","date","county","sub_county","facility_name","facility_level"],n=t.s,s=t.formatJson(a,n);e.export_json_to_excel({header:i,data:s,filename:t.filename,autoWidth:t.autoWidth,bookType:t.bookType}),t.downloadLoading=!1}))},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){return e[t]}))}))}}},k=y,D=(i("47e9"),i("2877")),w=Object(D["a"])(k,a,n,!1,null,null,null);e["default"]=w.exports},d402:function(t,e,i){}}]);
//# sourceMappingURL=chunk-3bfc840d.e1ceba97.js.map